<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sign Up</title>
    <link href="../static/assets/img/favicon-16x16.png" rel="icon">

    <!-- GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css?family=Karla:400,700|Roboto" rel="stylesheet">
    <link href="../static/plugins/material/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="../static/plugins/simplebar/simplebar.css" rel="stylesheet" />

    <!-- PLUGINS CSS STYLE -->
    <link href="..static/plugins/nprogress/nprogress.css" rel="stylesheet" />
    
    <!-- MONO CSS -->
    <link id="main-css-href" rel="stylesheet" href="../static/css/style.css" />

    <!-- FAVICON -->
    <link href="../static/assets/img/favicon-16x16.png" rel="shortcut icon">

    <!--
        HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="../static/plugins/nprogress/nprogress.js"></script>
</head>

<body class="bg-light-gray" id="body">
    <div class="container d-flex align-items-center justify-content-center" style="min-height: 100vh">
        <div class="d-flex flex-column justify-content-between">
            <div class="row justify-content-center">
                <div class="col-lg-6 col-xl-5 col-md-10 ">
                    <div class="card card-default mb-0">
                        <div class="card-header pb-0">
                            <div class="app-brand w-100 d-flex justify-content-center border-bottom-0">
                                <a class="w-auto pl-0" href="/index.html">
                                    <img src="../static/images/habib.png" alt="Mono">
                                        <span class="brand-name text-dark">HU Complaint Portal</span>
                                </a>
                            </div>
                        </div>

                        <div class="card-body px-5 pb-5 pt-0">
                            <h4 class="text-dark text-center mb-5">Sign Up</h4>

                            <form action="/register-submit" method="POST" onsubmit= "return to_submit();">
                                <div class="row" id = "r">

                                    <div class="col-md-12">

                                        {% if message %}
                                            <label id = "error" style="color: red;"> {{ message | safe }} </label>
                                        {% endif %}

                                        <div class="d-flex justify-content-between mb-3">

                                            <div class="custom-control custom-checkbox mr-3 mb-3">
                                                <input type="radio" class="custom-control-input" name ="u_type" id="adminCheck" value = "Admin"  onclick = "enable_all();" required>
                                                <label class="custom-control-label" for="adminCheck">Admin</label>
                                            </div>
        
                                            <div class="custom-control custom-checkbox mr-3 mb-3">
                                                <input type="radio" class="custom-control-input" name = "u_type" id="studentCheck" value = "Student" onclick = "enable_all();" required>
                                                <label class="custom-control-label" for="studentCheck">Student</label>
                                            </div>
                        
                                        </div>  
                                    </div>
                    
                                    <div class="form-group col-md-12 mb-4">
                                        <input type="text" class="form-control input-lg" id="fname" name = "fname" aria-describedby="nameHelp" placeholder="First Name"disabled required>
                                    </div>

                                    <div class="form-group col-md-12 mb-4">
                                        <input type="text" class="form-control input-lg" id="lname" name = "lname" aria-describedby="nameHelp" placeholder="Last Name" disabled required>
                                    </div>

                                    <div class="form-group col-md-12 mb-4" id = "student_id">
                                        <input type="text" class="form-control input-lg" id="s_id" name = "s_id" aria-describedby="idHelp" placeholder="StudentID" disabled required>
                                        <span class="d-block mt-1">Format: ak05419</span>
                                    </div>
                    
                                    <div class="form-group col-md-12 mb-4" id = "batch">
                                        <input type="number" class="form-control input-lg" id="s_batch" name = "s_batch" aria-describedby="batchHelp" placeholder="Batch" min ="2018" disabled>
                                    </div>

                                    <div class="form-group col-md-12 mb-4">
                                        <input type="email" class="form-control input-lg" id="email" name = "email" aria-describedby="emailHelp" placeholder="Email" disabled required>
                                    </div>

                                    <div class="form-group col-md-12 ">
                                        <input type="password" class="form-control input-lg" id="password" name = "password" placeholder="Password" disabled required>
                                    </div>

                                    <div class="form-group col-md-12 mb-4" id = "student_program">
                                        <select class = "form-control-lg" name="program" id="s_program" disabled required>
                                        <option value="" id = "1" disabled selected hidden>Program</option>
                                        {% for p in program %}
                                            <option value="{{p[0]}}">{{p[0]}}</option>
                                        {% endfor %}
                                        </select> 
                                    </div>

                                    <div class="form-group col-md-12 mb-4" id = "admin_department" hidden = "hidden">
                                        <select class = "form-control-lg" name="program" id="a_department">
                                          <option value="" id = "1" disabled selected hidden>Department</option>
                                          {% for d in department %}
                                            <option value="{{d[0]}}">{{d[0]}}</option>
                                          {% endfor %}
                                        </select>
                                    </div>
                    
                                    <div class="col-md-12">

                                        <button type="submit" id = "submit-btn" class="btn btn-primary btn-pill mb-4" disabled>Sign Up</button>

                                        <p>Already have an account?
                                            <a class="text-blue" href="{{url_for('login')}}">Sign in</a>
                                        </p>
                                    </div>

                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        function enable_all()
        {
            if (document.getElementById('studentCheck').checked)
            {
                // check if batch input field is hidden or not
                var element = document.getElementById("s_batch");
                // if field is not hidden
                if(typeof(element) == 'undefined' && element != null)
                {
                    element.setAttribute('required', '');               
                }
                // if batch input field is hidden
                else
                {
                    // show batch input field
                    var element = document.getElementById("batch");
                    element.style.display = 'inline-block';
                    element.setAttribute('required', '');

                    // change placeholder value of user id input field 
                    var child = document.getElementById("s_id");
                    child.placeholder = "StudentID";

                    // show student program input field
                    var element = document.getElementById('student_program');
                    element.style.display = 'inline-block';
                    
                    var element = document.getElementById('s_program');
                    element.setAttribute('required', '');

                    // check if admin department input field is hidden or not
                    var element = document.getElementById("admin_department");
                    hidden = element.getAttribute("hidden");

                    if (!hidden)
                    {
                        element.setAttribute("hidden", "hidden");
                    }
                    
                    var element = document.getElementById('a_department');
                    element.removeAttribute('required');
                }    
            }

            else if (document.getElementById('adminCheck').checked)
            {
                // hide batch input field
                var element = document.getElementById("batch");
                element.style.display = 'none';
                element.removeAttribute('required');

                // change placeholder name of student id input field
                var element = document.getElementById("student_id");
                var child = document.getElementById("s_id");
                child.placeholder = "AdminID";

                // hide student program input field
                var element = document.getElementById('student_program');
                element.style.display = 'none';

                var element = document.getElementById('s_program');
                element.removeAttribute('required');

                // check if admin department container is hidden or not
                var element = document.getElementById("admin_department");
                hidden = element.getAttribute("hidden");

                // if it is hidden, unhide it
                if (hidden)
                {
                    element.removeAttribute("hidden");
                }

                var element = document.getElementById('a_department');
                element.setAttribute('required', '');
            }
            
            document.getElementById('fname').disabled = false;
            document.getElementById('lname').disabled = false;
            document.getElementById('s_id').disabled = false;
            document.getElementById('s_batch').disabled = false;
            document.getElementById('email').disabled = false;
            document.getElementById('password').disabled = false;
            document.getElementById('s_program').disabled = false;
            document.getElementById('submit-btn').disabled = false;
        }

        function to_submit()
        {
            // email address and user id must match a specific format before it can be sent to the database
            var user_id = document.getElementById('s_id');
            var user_email = document.getElementById('email');

            if (document.getElementById('studentCheck').checked)
            {
                if ((user_id.value.length == 7) && (/^([a-z]{2})(\d{5})$/.test(user_id.value)) && (/^([a-z]{2})\d{5}@st.habib.edu.pk$/.test(user_email.value)))
                {
                    document.getElementById("error").innerHTML = "";
                    return true;
                }
                else
                {
                    document.getElementById('error').innerHTML = "";
                    document.getElementById("error").innerHTML = "Please check the format of your ID and Email Address.";
                    return false;
                }
            }
            else if (document.getElementById('adminCheck').checked) 
            {
                if ((user_id.value.length == 7) && (/^([a-z]{2})(\d{5})$/.test(user_id.value)) && (/^([a-z]{2})\d{5}@habib.edu.pk$/.test(user_email.value)))
                {
                    document.getElementById("error").innerHTML = "";
                    return true;
                }
                else
                {
                    document.getElementById('error').innerHTML = "";
                    document.getElementById("error").innerHTML = "Please check the format of your ID and Email Address.";
                    return false;
                }
            }
        }

    </script>

</body>
</html>
